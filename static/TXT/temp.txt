<!DOCTYPE html>
<html lang="en">
<%- include('./partials/head.ejs') %>

  <body>
    <%- include('./partials/nav.ejs') %>
      <!-- <form id="register" method="post" action="api/register" enctype="multipart/form-data"> -->
      <form id="register" method="post" action="api/register" enctype="multipart/form-data">
        <div class="form-info">
          <label>name
            <input type="text" name="username" id="username">
          </label>

          <label>email
            <input type="text" name="email" id="email">
          </label>

          <label class="form-label">Password
            <input type="text" name="password" id="password">
          </label>
          
          <div class="input-group"></div>
          <label>Foto
            <input type="file" name="foto" id="foto" class="form-control mb-3 " aria-describedby="inputGroupFileAddon03"
              aria-label="Upload">
          </label>
        </div>

        </div>
        <div>
          <input type="submit" value="Submit" class="btn btn-primary">
        </div>

      </form>
      <div>
        <%= message %>
      </div>
  </body>

</html>


<!-- <!DOCTYPE html>
<html lang="en">
<%- include('./partials/head.ejs') %>


  <body class="home">
    <%- include('./partials/nav.ejs') %>

      <div style="margin: 50px;">

        <div>Username
          <p>
            <%= user.username %>
          </p>
        </div>


        <div>FirstName
          <p>
            <%= user.firstName %>
          </p>
        </div>
        <div>LastName
          <p>
            <%= user.lastName %>
          </p>
        </div>

        <div>Email
          <p>
            <%= user.email %>
          </p>
        </div>

        <div>Foto
          <img src="data:image/png;base64,<%= user.foto %>" width="20%" height="20%" object-fit="cover">

        </div>
        <button id="logout-btn" style="margin-top: 20px;">LogOut</button>
      </div>
      <button id="edit-btn" style="margin-top: 10px;">Edit</button>

      <%- include('./partials/footer.ejs') %>

        <input type="hidden" id="user-data" value="<%= JSON.stringify(user) %>">

        <script>
          const userDataElement = document.getElementById('user-data');
          const user9 = JSON.parse(userDataElement.value);
          localStorage.setItem('currentUser', JSON.stringify(user9));
        </script>

        <script>
          document.getElementById('logout-btn').addEventListener('click', function () {
            localStorage.removeItem('currentUser');
            window.location.href = '/';
          });
        </script>

        <script>

          const storedUser = localStorage.getItem('currentUser');
          const user = storedUser ? JSON.parse(storedUser) : null;

          document.getElementById('edit-btn').addEventListener('click', function () {
            window.location.href = `/edituser?id=${user._id}`;
          });
        </script>


        <style>
          .home {
            display: flex;
            min-height: 100vh;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-size: 12px;
            background-color: #cfe7ed;
            color: black;
            padding-top: 0;
          }

          .userfoto {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ccc;
          }
        </style>

        <script src="/js/userfoto.js"></script>
  </body>

</html> -->


Есть код

<!DOCTYPE html>
<html lang="en">
<%- include('./partials/head.ejs') %>

  <body class="home">

    <%- include('./partials/nav.ejs') %>


      <div class="container py-5">
        <div class="row justify-content-center">
          <div class="col-lg-8 col-md-10">
            <div class="text-center mb-4">
              <h2>Title</h2>
              <p>
                <%= collection.title %>
              </p>
            </div>

            <div class="text-center mb-4">
              <h4>Content</h4>
              <textarea class="form-control" rows="8"><%= collection.content %></textarea>
            </div>

            <div class="row text-center">
              <div class="col-12 col-md-4 mb-3">
                <h5>Foto</h5>
                <img src="data:image/png;base64,<%= collection.foto %>" class="img-fluid rounded">
              </div>
              <div class="col-12 col-md-4 mb-3">
                <h5>Foto1</h5>
                <img src="data:image/png;base64,<%= collection.foto1 %>" class="img-fluid rounded">
              </div>
              <div class="col-12 col-md-4 mb-3">
                <h5>Foto2</h5>
                <img src="data:image/png;base64,<%= collection.foto2 %>" class="img-fluid rounded">
              </div>
            </div>
          </div>
        </div>

        <%- include('./partials/footer.ejs') %>
          <script src="/js/userfoto.js"></script>

          <script>
            document.addEventListener('DOMContentLoaded', () => {
              const storedUser = localStorage.getItem('currentUser');
              const userId = storedUser ? JSON.parse(storedUser) : null;

              if (userId) {
                document.getElementById('cuser').value = userId._id;
              } else {
                alert('Please log in or register to continue.');
                window.location.href = '/';
              }
            });

          </script>

  </body>

</html>

Необходимо сделать из этого форму для редактирования элемента коллекции
<form id="editcollection" method="post" action="api/editcollection" enctype="multipart/form-data">

Необходимо еще сделать так чтобы при выборе файла картинки он показывался в окне фото

Можно сделать чтобы блок фото размещался горизонтально как в коде

<div class="row text-center">
                <div class="col-12 col-md-4 mb-3">
                  <h5>Foto</h5>
                  <img src="data:image/png;base64,<%= collection.foto %>" class="img-fluid rounded mb-2">
                  <input type="file" name="foto" accept="image/*" class="form-control">
                </div>
                <div class="col-12 col-md-4 mb-3">
                  <h5>Foto1</h5>
                  <img src="data:image/png;base64,<%= collection.foto1 %>" class="img-fluid rounded mb-2">
                  <input type="file" name="foto1" accept="image/*" class="form-control">
                </div>
                <div class="col-12 col-md-4 mb-3">
                  <h5>Foto2</h5>
                  <img src="data:image/png;base64,<%= collection.foto2 %>" class="img-fluid rounded mb-2">
                  <input type="file" name="foto2" accept="image/*" class="form-control">
                </div>
              </div>


Есть код

<!DOCTYPE html>
<html lang="en">
<%- include('./partials/head.ejs') %>

  <body class="home">
    <%- include('./partials/nav.ejs') %>

      <div class="container py-5">
        <div class="row justify-content-center">
          <div class="col-lg-8 col-md-10">
            <div class="text-center mb-4">
              <h2>Title</h2>
              <p>
                <%= collection.title %>
              </p>
            </div>

            <div class="text-center mb-4">
              <h4>Content</h4>
              <textarea class="form-control" rows="8"><%= collection.content %></textarea>
            </div>

            <div class="row text-center">
              <div class="col-12 col-md-4 mb-3">
                <h5>Foto</h5>
                <img src="data:image/png;base64,<%= collection.foto %>" class="img-fluid rounded">
              </div>
              <div class="col-12 col-md-4 mb-3">
                <h5>Foto1</h5>
                <img src="data:image/png;base64,<%= collection.foto1 %>" class="img-fluid rounded">
              </div>
              <div class="col-12 col-md-4 mb-3">
                <h5>Foto2</h5>
                <img src="data:image/png;base64,<%= collection.foto2 %>" class="img-fluid rounded">
              </div>
            </div>


            <div>
              <h5>Owner</h5>
              <p>
                <%= collection.user.firstName %>
              </p>
              <img src="data:image/png;base64,<%= collection.user.foto %>" class="img-fluid rounded">
            </div>



          </div>
        </div>

        <div class="text-center my-4">
          <button class="btn btn-success" onclick="goToIndex()">Return</button>
        </div>


        <div id="actionButtons" class="text-center my-4"></div>


      </div>

      <input type="hidden" id="collection_id" value="<%= collection.id %>">

      <%- include('./partials/footer.ejs') %>

        <style>
          .home {
            display: flex;
            min-height: 100vh;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-size: 12px;
            background-color: #cfe7ed;
            color: black;
            padding-top: 0;
          }

          .userfoto {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ccc;
          }
        </style>

        <script>
          // Переход на главную с сохранённой страницей
          function goToIndex() {
            const page = localStorage.getItem('galleryPage') || 1;
            localStorage.removeItem('galleryPage');
            window.location.href = `/?page=${page}`;
          }

        </script>

        <script src="/js/userfoto.js"></script>


        <script src="/js/gallery.js"></script>

        <script>

          const creatorId = '<%= collection.user._id %>'; // ID создателя из EJS
          const collectionId = '<%= collection._id %>';

          if (user && (user.role === 'admin' || user.id === creatorId)) {
            const container = document.getElementById('actionButtons');

            const editBtn = document.createElement('button');
            editBtn.className = 'btn btn-primary me-2';
            editBtn.textContent = 'Edit';
            editBtn.id = "edit-btn";
            //editBtn.onclick = () => editCollection(collectionId);

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'btn btn-danger';
            deleteBtn.textContent = 'Delete';
            deleteBtn.id = "delete-btn";
            //deleteBtn.onclick = () => deleteCollection(collectionId);

            container.appendChild(editBtn);
            container.appendChild(deleteBtn);
          }
        </script>

        <script>
          document.getElementById('edit-btn').addEventListener('click', function () {
            window.location.href = `/editcollection?id=${collection_id.value}`;
          });

          document.getElementById('delete-btn').addEventListener('click', function () {
            const page = localStorage.getItem('galleryPage') || 1;
            const isConfirmed = confirm('Are you sure you want to delete the collection?');

            if (isConfirmed) {
              window.location.href = `/deletecollection?id=${collectionId}&page=${page}`;
            } else {
              alert('Deletion cancelled by user');
            }
          });
        </script>

  </body>

</html>


<script>

почему не отображается 

            <div>
              <h5>Owner</h5>
              <p>
                <%= collection.user.firstName %>
              </p>
              <img src="data:image/png;base64,<%= collection.user.foto %>" class="img-fluid rounded">
            </div>


 В модели collection содержится
                user: {
        type: mongoose.Schema.Types.ObjectId,
        ref: "User"
    }

    как его передать как объект в 
const User = require('../models/userModel.js');
...
    const collection = (req, res) => {
    const title = 'My collection';
    const collectionId = req.query.id;

    Collection
        .findById(collectionId)
        .then((collection) => res.render(createPath('collection'), { collection }))
        .catch((error) => handleError(res, error));
};

для дальнейшей обработки